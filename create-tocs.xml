<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." name="create-tocs">

    <!-- data directories -->
    <property name="contentDir" value="./OEBPS"/>
    <property name="textDir" value="./OEBPS/texts"/>

    <!-- temporary directories -->
    <property name="contentTmp" value="./OEBPS/contentTmp"/>
    <delete dir="${contentTmp}"/>
    <mkdir dir="${contentTmp}"/>

    <property name="inhaltTmp" value="./OEBPS/texts/inhaltTmp"/>
    <delete dir="${inhaltTmp}"/>
    <mkdir dir="${inhaltTmp}"/>

    <property name="inhaltsverzeichnisTmp" value="./OEBPS/texts/inhaltsverzeichnisTmp"/>
    <delete dir="${inhaltsverzeichnisTmp}"/>
    <mkdir dir="${inhaltsverzeichnisTmp}"/>

    <!-- transform OEBPS/content.opf with create-content.xsl -->
    <xslt style="./xslt/create-content.xsl" destdir="${contentTmp}" basedir="${contentDir}"
        includes="${contentDir}/content.opf" extension=".opf">
        <factory name="net.sf.saxon.TransformerFactoryImpl"/>
        <classpath location="./saxon/saxon9he.jar"/>
    </xslt>
    <move todir="${contentDir}">
        <fileset dir="${contentTmp}"/>
    </move>
    <delete dir="${contentTmp}"/>

    <!-- transform OEBPS/texts/inhalt.xhtml with create-inhalt.xsl -->
    <xslt style="./xslt/create-inhalt.xsl" destdir="${inhaltTmp}" basedir="${textDir}"
        includes="${textDir}/inhalt.xhtml" extension=".xhtml">
        <factory name="net.sf.saxon.TransformerFactoryImpl"/>
        <classpath location="./saxon/saxon9he.jar"/>
    </xslt>
    <move todir="${textDir}">
        <fileset dir="${inhaltTmp}"/>
    </move>
    <delete dir="${inhaltTmp}"/>

    <!-- transform OEBPS/texts/inhaltsverzeichnis.ncx with create-inhaltsverzeichnis.xsl -->
    <xslt style="./xslt/create-inhaltsverzeichnis.xsl" destdir="${inhaltsverzeichnisTmp}"
        basedir="${textDir}" includes="${textDir}/inhaltsverzeichnis.ncx" extension=".ncx">
        <factory name="net.sf.saxon.TransformerFactoryImpl"/>
        <classpath location="./saxon/saxon9he.jar"/>
    </xslt>
    <move todir="${textDir}">
        <fileset dir="${inhaltsverzeichnisTmp}"/>
    </move>
    <delete dir="${inhaltsverzeichnisTmp}"/>

</project>
